// 修复 LandingPage.tsx 中的内联翻译
// 将 currentLang.startsWith('zh') ? '繁體文字' 改为区分 zh-TW 和 zh-CN
const fs = require('fs');
const path = require('path');

// 合并所有繁简对照映射
const t2sMap = {
  '體': '体', '檢': '检', '會': '会', '務': '务', '際': '际',
  '門': '门', '爾': '尔', '夥': '伙', '導': '导', '遊': '游', '簡': '简',
  '員': '员', '報': '报', '價': '价', '預': '预', '見': '见', '時': '时',
  '課': '课', '術': '术', '療': '疗', '醫': '医', '藥': '药', '險': '险',
  '細': '细', '處': '处', '進': '进', '產': '产', '業': '业', '專': '专',
  '團': '团', '開': '开', '關': '关', '請': '请', '過': '过', '選': '选',
  '還': '还', '這': '这', '裡': '里', '麼': '么', '後': '后', '對': '对',
  '當': '当', '號': '号', '學': '学', '實': '实', '發': '发', '設': '设',
  '計': '计', '認': '认', '識': '识', '車': '车', '輛': '辆', '運': '运',
  '動': '动', '場': '场', '電': '电', '話': '话', '訊': '讯', '機': '机',
  '區': '区', '準': '准', '標': '标', '達': '达', '遠': '远', '東': '东',
  '廣': '广', '萬': '万', '億': '亿', '歲': '岁', '個': '个', '條': '条',
  '間': '间', '問': '问', '題': '题', '頁': '页', '頭': '头', '腦': '脑',
  '臉': '脸', '飛': '飞', '風': '风', '氣': '气', '師': '师', '隊': '队',
  '層': '层', '據': '据', '點': '点', '線': '线', '經': '经', '總': '总',
  '結': '结', '給': '给', '統': '统', '類': '类', '級': '级', '組': '组',
  '紅': '红', '綠': '绿', '藍': '蓝', '黃': '黄', '灣': '湾', '島': '岛',
  '華': '华', '國': '国', '語': '语', '說': '说', '讀': '读',
  '書': '书', '寫': '写', '畫': '画', '圖': '图', '長': '长', '無': '无',
  '從': '从', '來': '来', '質': '质', '節': '节', '單': '单',
  '雙': '双', '裝': '装', '農': '农', '鄉': '乡', '縣': '县', '鎮': '镇',
  '樓': '楼', '廳': '厅', '館': '馆', '觀': '观',
  '覽': '览', '園': '园', '廠': '厂', '礦': '矿', '銀': '银', '錢': '钱',
  '貨': '货', '買': '买', '賣': '卖', '貴': '贵', '賓': '宾', '參': '参',
  '訪': '访', '聯': '联', '繫': '系', '絡': '络', '網': '网', '傳': '传',
  '輸': '输', '郵': '邮', '環': '环', '護': '护',
  '衛': '卫', '養': '养', '飲': '饮', '廚': '厨',
  '燒': '烧', '魚': '鱼',
  '鳥': '鸟', '雞': '鸡', '鴨': '鸭', '龍': '龙', '馬': '马', '驗': '验',
  '證': '证', '辦': '办', '執': '执', '營': '营', '貿': '贸', '財': '财',
  '稅': '税', '費': '费', '補': '补', '償': '偿', '賠': '赔', '擔': '担',
  '監': '监', '審': '审', '詢': '询', '諮': '咨', '顧': '顾', '議': '议',
  '論': '论', '評': '评', '測': '测', '試': '试', '調': '调',
  '創': '创', '構': '构', '築': '筑', '維': '维',
  '優': '优', '勝': '胜', '負': '负', '贏': '赢',
  '競': '竞', '爭': '争', '協': '协', '約': '约', '則': '则', '規': '规',
  '範': '范', '職': '职', '責': '责', '義': '义', '權': '权',
  '決': '决', '許': '许',
  '訂': '订', '購': '购', '銷': '销', '儲': '储', '積': '积',
  '備': '备', '領': '领', '帶': '带',
  '屆': '届', '圍': '围', '歷': '历',
  '齡': '龄', '齊': '齐', '齒': '齿', '龜': '龟', '臟': '脏',
  '腸': '肠', '膽': '胆', '傷': '伤',
  '瘤': '瘤', '劑': '剂',
  '針': '针', '脈': '脉', '診': '诊', '斷': '断',
  '愛': '爱', '戀': '恋', '親': '亲', '樂': '乐', '禮': '礼',
  '壽': '寿', '慶': '庆', '獎': '奖', '賞': '赏', '讚': '赞', '嘆': '叹',
  '驚': '惊', '懷': '怀', '憶': '忆',
  '憂': '忧', '慮': '虑', '顯': '显', '隱': '隐',
  '寶': '宝', '貝': '贝', '鑽': '钻',
  '錶': '表', '鏡': '镜', '攝': '摄', '錄': '录',
  '視': '视', '聽': '听', '播': '播',
  '極': '极', '盡': '尽', '滿': '满', '漸': '渐', '僅': '仅',
  '適': '适', '豐': '丰', '榮': '荣', '譽': '誉',
  '興': '兴', '敗': '败', '績': '绩', '效': '效',
  '靈': '灵', '響': '响', '頻': '频', '譯': '译', '釋': '释',
  '閱': '阅', '複': '复', '製': '制', '雜': '杂',
  '縮': '缩', '擴': '扩', '張': '张', '編': '编',
  '輯': '辑', '碼': '码', '軟': '软', '檔': '档',
  '資': '资', '庫': '库', '盤': '盘',
  '鍵': '键', '幾': '几', '騎': '骑',
  '駕': '驾', '駛': '驶', '輪': '轮', '艙': '舱', '艦': '舰',
  '陸': '陆', '橋': '桥', '壩': '坝',
  '堅': '坚', '磚': '砖', '鋼': '钢',
  '鐵': '铁', '銅': '铜', '鋁': '铝', '鋅': '锌', '鉛': '铅', '錫': '锡',
  '採': '采',
  '壓': '压', '煉': '炼', '鑄': '铸', '鍛': '锻',
  '儀': '仪',
  '閥': '阀',
  '濾': '滤', '淨': '净', '殺': '杀',
  '滅': '灭', '爐': '炉', '窯': '窑',
  '乾': '干', '濕': '湿', '溫': '温', '熱': '热', '凍': '冻',
  '涼': '凉', '燙': '烫',
  '應': '应', '該': '该', '讓': '让',
  '變': '变',
  '屬': '属',
  '獲': '获', '穩': '稳',
  '竄': '窜', '竅': '窍', '竊': '窃',
  '筆': '笔', '籌': '筹', '籃': '篮',
  '籠': '笼', '籤': '签',
  '練': '练', '緊': '紧', '縫': '缝',
  '繩': '绳', '繪': '绘', '繳': '缴', '繼': '继', '續': '续', '纖': '纤',
  '納': '纳', '紐': '纽', '純': '纯', '紗': '纱', '紙': '纸',
  '紋': '纹', '紡': '纺', '終': '终',
  '紮': '扎',
  '絕': '绝', '絲': '丝', '綁': '绑',
  '綢': '绸', '緩': '缓',
  '緣': '缘', '緻': '致', '縛': '缚',
  '織': '织', '繡': '绣', '繞': '绕',
  '纏': '缠', '紀': '纪',
  '頂': '顶', '項': '项', '須': '须',
  '頓': '顿', '顆': '颗', '額': '额',
  '顏': '颜', '願': '愿', '飄': '飘',
  '飢': '饥', '飯': '饭', '飼': '饲', '飾': '饰',
  '餃': '饺', '餅': '饼', '駁': '驳',
  '駐': '驻',
  '騙': '骗', '騰': '腾',
  '驅': '驱',
  '髮': '发', '鬆': '松', '鬥': '斗',
  '鬧': '闹', '鬱': '郁', '鮮': '鲜', '鯉': '鲤', '鯊': '鲨',
  '鰻': '鳗', '鳳': '凤', '鳴': '鸣', '鴻': '鸿', '鵝': '鹅',
  '鷹': '鹰', '鹹': '咸', '麵': '面', '黨': '党',
  '齋': '斋', '龐': '庞',
  '殘': '残', '惡': '恶', '麗': '丽',
  '濃': '浓', '覺': '觉', '徹': '彻',
  '遷': '迁', '遲': '迟',
  '獻': '献', '徵': '征',
  '聲': '声',
  '傳': '传', '債': '债',
  '勵': '励',
  '圓': '圆',
  '塊': '块', '塵': '尘',
  '壞': '坏',
  '夢': '梦', '夾': '夹', '奪': '夺',
  '奮': '奋', '婦': '妇', '嬰': '婴',
  '寬': '宽', '寢': '寝',
  '將': '将',
  '幣': '币', '幫': '帮', '廢': '废',
  '彈': '弹', '彌': '弥', '彎': '弯',
  '態': '态', '憑': '凭', '憲': '宪', '懼': '惧', '懸': '悬',
  '戰': '战', '戲': '戏', '戶': '户',
  '攪': '搅',
  '敵': '敌', '數': '数',
  '暈': '晕',
  '暫': '暂', '曉': '晓',
  '樣': '样',
  '樸': '朴', '權': '权', '歐': '欧',
  '歡': '欢', '歸': '归',
  '殼': '壳', '毀': '毁', '氫': '氢',
  '沒': '没', '況': '况', '淚': '泪', '減': '减',
  '湧': '涌', '溝': '沟',
  '滯': '滞', '滾': '滚', '漁': '渔', '漲': '涨', '潑': '泼', '潔': '洁',
  '瀏': '浏',
  '災': '灾', '燈': '灯', '燦': '灿', '爺': '爷', '獄': '狱',
  '獨': '独', '獵': '猎', '現': '现',
  '畝': '亩', '畢': '毕', '異': '异',
  '癡': '痴', '皺': '皱',
  '眾': '众', '矚': '瞩',
  '確': '确',
  '禱': '祷',
  '種': '种',
  '窩': '窝', '窮': '穷',
  '糧': '粮',
  '纍': '累',
  // Additional from fix script
  '幹': '干', '擁': '拥', '隨': '随', '別': '别', '廂': '厢',
  '銳': '锐', '輻': '辐', '偵': '侦', '掃': '扫', '篩': '筛',
  '閉': '闭', '狀': '状', '內': '内', '強': '强', '並': '并',
  '貼': '贴', '暢': '畅', '螢': '荧', '們': '们',
  '兌': '兑', '兒': '儿',
  '倉': '仓', '倆': '俩',
  '倫': '伦', '傑': '杰', '傘': '伞',
  '僑': '侨', '僕': '仆',
  '冊': '册', '凈': '净', '凜': '凛',
  '凱': '凯', '剎': '刹', '剛': '刚',
  '劃': '划', '劇': '剧', '劉': '刘', '劍': '剑',
  '勛': '勋', '勞': '劳',
  '勢': '势', '勸': '劝',
  '佔': '占',
  '叢': '丛', '吳': '吴',
  '嗎': '吗', '嘗': '尝', '嚴': '严',
  '墊': '垫', '墜': '坠',
  '夠': '够',
  '寧': '宁',
  '尋': '寻',
  '帥': '帅',
  '捨': '舍',
  '損': '损', '擇': '择', '擊': '击',
  '擋': '挡', '擠': '挤', '擬': '拟',
  '攤': '摊', '攬': '揽',
  '於': '于',
  '晝': '昼',
  '棲': '栖',
  '牆': '墙',
  '濟': '济', '濤': '涛',
  '瀾': '澜',
  '癒': '愈',
  '盧': '卢',
  '礎': '础',
  '紹': '绍',
  '綜': '综', '綱': '纲',
  '總': '总',
  '罰': '罚', '羅': '罗',
  '聖': '圣', '聞': '闻',
  '臺': '台', '與': '与', '舊': '旧', '艷': '艳',
  '莊': '庄', '菸': '烟', '萊': '莱',
  '葉': '叶', '蓋': '盖', '蔣': '蒋', '蔥': '葱', '蘆': '芦', '蘇': '苏',
  '蘊': '蕴', '蘋': '苹', '蘭': '兰', '虛': '虚', '蟻': '蚁',
  '蠟': '蜡', '衝': '冲',
  '裡': '里',
  '褲': '裤',
  '記': '记',
  '討': '讨', '訓': '训',
  '詩': '诗',
  '詳': '详', '誌': '志',
  '誠': '诚', '誤': '误',
  '談': '谈', '謂': '谓', '講': '讲',
  '謝': '谢', '譜': '谱',
  '贊': '赞', '贈': '赠',
  '貢': '贡',
  '販': '贩', '貸': '贷',
  '賀': '贺', '賜': '赐',
  '賢': '贤', '賴': '赖',
  '賺': '赚', '賽': '赛', '軍': '军', '軌': '轨',
  '軒': '轩', '載': '载', '較': '较', '輔': '辅',
  '輕': '轻', '輝': '辉', '輩': '辈',
  '轉': '转', '轎': '轿',
  '連': '连', '週': '周',
  '遺': '遗',
  '邊': '边',
  '鄭': '郑', '鄰': '邻', '醜': '丑', '醬': '酱',
  '鋒': '锋', '錦': '锦',
  '鍋': '锅', '鎖': '锁',
  '鏈': '链', '鐘': '钟',
  '閃': '闪', '閒': '闲',
  '閣': '阁',
  '陣': '阵', '陰': '阴', '陳': '陈', '陽': '阳',
  '階': '阶',
  '隸': '隶', '離': '离',
  '難': '难', '雲': '云', '霧': '雾',
  '靜': '静', '順': '顺',
  '飽': '饱', '餘': '余',
  '為': '为', '遼': '辽',
  '臨': '临', '釀': '酿', '攏': '拢',
  '藝': '艺', '藍': '蓝', '蕩': '荡',
  '薦': '荐', '薩': '萨',
  '綢': '绸', '綿': '绵',
  '綺': '绮', '綻': '绽', '綽': '绰', '綾': '绫',
  '緒': '绪', '緞': '缎', '締': '缔',
  '緬': '缅', '緯': '纬',
  '絨': '绒', '絹': '绢',
  '紳': '绅',
  '習': '习',
  '膽': '胆',
  // Extra characters commonly seen in this file
  '諮': '咨', '詢': '询',
  '離': '离', '癌': '癌',
  '腫': '肿', '纖': '纤',
  '禦': '御', '擊': '击',
  '損': '损', '靶': '靶',
  '遞': '递', '縮': '缩',
  '鬥': '斗', '贏': '赢',
  '歷': '历', '戰': '战',
  '絡': '络',
  '齡': '龄',
  '內': '内',
  '陪': '陪',
  '陣': '阵',
  '萊': '莱',
  '關': '关',
  '鏡': '镜',
  '蝦': '虾',
};

// Convert Traditional Chinese text to Simplified Chinese
function t2s(text) {
  let result = '';
  for (const char of text) {
    result += t2sMap[char] || char;
  }
  return result;
}

// Read the file
const filePath = path.join(__dirname, '..', 'components', 'LandingPage.tsx');
let content = fs.readFileSync(filePath, 'utf8');

// Pattern 1: currentLang.startsWith('zh') ? '...' :
// This matches inline ternary with single-quoted string after startsWith('zh') ?
// We need to handle both single-line patterns

let changeCount = 0;

// Replace pattern: currentLang.startsWith('zh') ? '繁體文字' :
// With: currentLang === 'zh-TW' ? '繁體文字' : currentLang === 'zh-CN' ? '简体文字' :
content = content.replace(
  /currentLang\.startsWith\('zh'\)\s*\?\s*'([^']+)'\s*:/g,
  (match, zhTWText) => {
    const zhCNText = t2s(zhTWText);
    changeCount++;
    return `currentLang === 'zh-TW' ? '${zhTWText}' : currentLang === 'zh-CN' ? '${zhCNText}' :`;
  }
);

// Pattern 2: currentLang.startsWith('zh') ? "..." :  (double quotes)
content = content.replace(
  /currentLang\.startsWith\('zh'\)\s*\?\s*"([^"]+)"\s*:/g,
  (match, zhTWText) => {
    const zhCNText = t2s(zhTWText);
    changeCount++;
    return `currentLang === 'zh-TW' ? "${zhTWText}" : currentLang === 'zh-CN' ? "${zhCNText}" :`;
  }
);

// Pattern 3: {currentLang.startsWith('zh') ? '...' : '...'}  (complete ternary in JSX)
// Already handled by Pattern 1 above since it matches the first part

// Pattern 4: Multi-line pattern where the ternary spans lines
// currentLang.startsWith('zh')
//   ? '...'
//   : '...'
content = content.replace(
  /currentLang\.startsWith\('zh'\)\s*\n\s*\?\s*'([^']+)'/g,
  (match, zhTWText) => {
    const zhCNText = t2s(zhTWText);
    changeCount++;
    return `currentLang === 'zh-TW'\n              ? '${zhTWText}'\n              : currentLang === 'zh-CN' ? '${zhCNText}'`;
  }
);

// Pattern 5: Template literal with startsWith
content = content.replace(
  /currentLang\.startsWith\('zh'\)\s*\?\s*`([^`]+)`\s*:/g,
  (match, zhTWText) => {
    const zhCNText = t2s(zhTWText);
    changeCount++;
    return `currentLang === 'zh-TW' ? \`${zhTWText}\` : currentLang === 'zh-CN' ? \`${zhCNText}\` :`;
  }
);

// Write the file back
fs.writeFileSync(filePath, content, 'utf8');

console.log(`✓ 已替换 ${changeCount} 处内联翻译`);
console.log('  - zh-TW: 保持繁體中文');
console.log('  - zh-CN: 自动转换为简体中文');

// Verify: check if any startsWith('zh') remains
const remaining = content.match(/currentLang\.startsWith\('zh'\)/g);
if (remaining) {
  console.log(`\n⚠ 仍有 ${remaining.length} 处 startsWith('zh') 未替换，可能需要手动处理`);
}
